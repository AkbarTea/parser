########################################################################################################################

[CREATE]

########################################################################################################################

temp_rel_domain_datatype:
    CREATE TABLE dbd$tmpdatatype
        (domain_name varchar NOT NULL
        ,datatype_name varchar NOT NULL)


########################################################################################################################

[INSERT]

########################################################################################################################
schema:
    INSERT INTO dbd$schemas (
         name
    )
    VALUES (
         :name
    )

add_rel_to_temp:
    INSERT INTO dbd$tmpdatatype
        VALUES(
        :domain_name
        ,:datatype_name)


domain :
    INSERT INTO dbd$domains (
        name
        ,description
        ,length
        ,char_length
        ,precision
        ,scale
        ,width
        ,align
        ,show_null
        ,show_lead_nulls
        ,thousands_separator
        ,summable
        ,case_sensitive
        ,data_type_id
        ,uuid
    )
    VALUES (
         :name
        ,:description
        ,:length
        ,:char_length
        ,:precision
        ,:scale
        ,:width
        ,:align
        ,:show_null
        ,:show_lead_nulls
        ,:thousands_separator
        ,:summable
        ,:case_sensitive
        ,:data_type_id
        ,:uuid
    )

table :
    INSERT INTO dbd$tables (
         schema_id
        ,name
        ,description
        ,can_add
        ,can_edit
        ,can_delete
        ,temporal_mode
        ,means
        ,uuid
    )
    VALUES (
         :schema_id
        ,:name
        ,:description
        ,:can_add
        ,:can_edit
        ,:can_delete
        ,:temporal_mode
        ,:means
        ,:uuid
    )

field:
     INSERT INTO dbd$fields (
             table_id
            ,position
            ,name
            ,russian_short_name
            ,description
            ,domain_id
            ,can_input
            ,can_edit
            ,show_in_grid
            ,show_in_details
            ,is_mean
            ,autocalculated
            ,required
            ,uuid
        )
     VALUES (
         :table_id
        ,:position
        ,:name
        ,:russian_short_name
        ,:description
        ,:domain_id
        ,:can_input
        ,:can_edit
        ,:show_in_grid
        ,:show_in_details
        ,:is_mean
        ,:autocalculated
        ,:required
        ,:uuid
     )

constraint:
     INSERT INTO dbd$constraints (
             table_id
            ,name
            ,constraint_type
            ,reference
            ,unique_key_id
            ,has_value_edit
            ,cascading_delete
            ,expression
            ,uuid
        )
     VALUES (
             :table_id
            ,:name
            ,:constraint_type
            ,:reference
            ,:unique_key_id
            ,:has_value_edit
            ,:cascading_delete
            ,:expression
            ,:uuid
     )

constraint_detail:
    INSERT INTO dbd$constraint_details (
         constraint_id
        ,position
        ,field_id
    )
    VALUES (
         :constraint_id
        ,:position
        ,:field_id
    )

index:
    INSERT INTO dbd$indices (
         table_id
        ,name
        ,local
        ,kind
        ,uuid
    )
    VALUES (
         :table_id
        ,:name
        ,:local
        ,:kind
        ,:uuid
    )

index_detail:
    INSERT INTO dbd$index_details (
         index_id
        ,position
        ,field_id
        ,expression
        ,descend
    )
    VALUES (
         :index_id
        ,:position
        ,:field_id
        ,:expression
        ,:descend
    )
########################################################################################################################

[UPDATE]

########################################################################################################################

update_unique_key:
    UPDATE dbd$constraints
    SET unique_key_id = :id

########################################################################################################################

[SELECT]

########################################################################################################################

get_schema_id:
    SELECT id,name FROM dbd$schemas
        WHERE name = :name


get_domains_id:
    SELECT id,name FROM dbd$domains

get_fields_id:
    SELECT id,name FROM dbd$fields
